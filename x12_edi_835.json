{
  "parser_settings": {
    "version": "omni.2.1",
    "file_format_type": "edi"
  },
  "file_declaration": {
    "segment_delimiter": "~",
    "element_delimiter": "*",
    "component_delimiter": ":",
    "ignore_crlf": true,
    "segment_declarations": [
      {
        "name": "era", "type": "segment_group", "is_target": true,
        "child_segments": [
          {"name": "ISA", 
            "elements": [
              {"name": "sender_interchange_qualifier","index": 5, "default": ""},
              {"name": "sender_id","index": 6, "default": ""}
            ]
          },
          {"name": "GS",
            "elements": [
              {"name": "app_sender_code", "index": 2},
              {"name": "date", "index": 4},
              {"name": "time", "index": 5}
            ]
          },
          {
            "name": "transactions",
            "type": "segment_group",
            "max": -1,
            "child_segments": [
              {"name": "ST"},
              {
                "name": "BPR",
                "elements": [
                  {"name": "transaction_handling_code", "index": 1},
                  {"name": "total_provider_payment", "index": 2},
                  {"name": "credit_debit", "index": 3},
                  {"name": "payment_method", "index": 4},
                  {"name": "payment_format", "index": 5},
                  {"name": "sender_dfi_id_qualifier", "index": 6},
                  {"name": "sender_dfi_id", "index": 7},
                  {"name": "sender_account_number_qualifier", "index": 8},
                  {"name": "sender_account_number", "index": 9},
                  {"name": "payer_identifier", "index": 10, "default": ""},
                  {"name": "originating_supp_code", "index": 11},
                  {"name": "receiver_dfi_id_qualifier", "index": 12},
                  {"name": "receiver_dfi_id", "index": 13, "default": ""},
                  {"name": "receiver_account_number_qualifier", "index": 14},
                  {"name": "receiver_account_number", "index": 15},
                  {"name": "transaction_date", "index": 16}
                ]
              },
              {
                "name": "TRN",
                "elements": [
                  {"name": "check_eft_trace", "index": 2},
                  {"name": "payer_identifier", "index": 3, "default":""}
                ]
              },
              {"name": "CUR", "min": 0},
              {"name": "REF", "min": 0, "max": 2,
                "elements": [
                  {"name": "ref_qualifier", "index": 1},
                  {"name": "ref_id", "index": 2, "default": ""}
                ]
              },
              {
                "name": "DTM", "min": 0,
                "elements": [
                  {"name": "dtm_qualifier", "index": 1},
                  {"name": "dtm_date", "index": 2, "default": ""}
                ]
              },
              {
                "name": "payerInfo",
                "type": "segment_group",
                "min": 1,
                "child_segments": [
                  {
                    "name": "N1",
                    "elements": [
                      {"name": "n1_qualifier", "index": 1},
                      {"name": "name", "index": 2},
                      {"name": "n1_id_qualifier", "index": 3, "default": ""},
                      {"name": "n1_id", "index": 4, "default": ""}
                    ]
                  },
                  {
                    "name": "N3",
                    "elements": [
                      {"name": "address_line_1", "index": 1, "default": ""},
                      {"name": "address_line_2", "index": 2, "default": ""}
                    ]
                  },
                  {
                    "name": "N4",
                    "elements": [
                      {"name": "city", "index": 1, "default": ""},
                      {"name": "state", "index": 2, "default": ""},
                      {"name": "zip", "index": 3, "default": ""}
                    ]
                  },
                  {"name": "REF", "min": 0, "max": 4,
                    "elements": [
                      {"name": "ref_qualifier", "index": 1},
                      {"name": "ref_id", "index": 2}
                    ]
                  },
                  {
                    "name": "PER", "min": 0, "max": 3,
                    "elements": [
                      {"name": "contact_function_code", "index": 1},
                      {"name": "contact_name", "index": 2, "default": ""},
                      {"name": "per_comm_qualifier_1", "index": 3, "default": ""},
                      {"name": "per_comm_1", "index": 4, "default": ""},
                      {"name": "per_comm_qualifier_2", "index": 5, "default": ""},
                      {"name": "per_comm_2", "index": 6, "default": ""},
                      {"name": "per_comm_qualifier_3", "index": 7, "default": ""},
                      {"name": "per_comm_3", "index": 8, "default": ""}
                    ]
                  }
                ]
              },
              {
                "name": "payeeInfo",
                "type": "segment_group",
                "min": 1,
                "child_segments": [
                  {
                    "name": "N1",
                    "elements": [
                      {"name": "n1_qualifier", "index": 1},
                      {"name": "name", "index": 2},
                      {"name": "n1_id_qualifier", "index": 3, "default": ""},
                      {"name": "n1_id", "index": 4, "default": ""}
                    ]
                  },
                  {
                    "name": "N3",
                    "elements": [
                      {"name": "address_line_1", "index": 1, "default": ""},
                      {"name": "address_line_2", "index": 2, "default": ""}
                    ]
                  },
                  {
                    "name": "N4",
                    "elements": [
                      {"name": "city", "index": 1, "default": ""},
                      {"name": "state", "index": 2, "default": ""},
                      {"name": "zip", "index": 3, "default": ""}
                    ]
                  },
                  {"name": "REF", "min": 0, "max": 4,
                    "elements": [
                      {"name": "ref_qualifier", "index": 1},
                      {"name": "ref_id", "index": 2}
                    ]
                  },
                  {
                    "name": "RDM", "min": 0,
                    "elements": [
                      {"name": "rdm_code", "index": 1, "default": ""},
                      {"name": "rdm_name", "index": 2, "default": ""},
                      {"name": "comm_number", "index": 3, "default": ""},
                      {"name": "ref_id", "index": 4, "default": ""}
                    ]
                  }
                ]
              },
              {
                "name": "providerClaims",
                "type": "segment_group",
                "min": 0,
                "max": -1,
                "child_segments": [
                  {"name": "LX", "min": 0},
                  {
                    "name": "TS3", "min": 0,
                    "elements": [
                      {"name": "provider_id", "index": 1},
                      {"name": "facility_code", "index": 2},
                      {"name": "date", "index": 3},
                      {"name": "quantity", "index": 4},
                      {"name": "total_charge_amount", "index": 5}
                    ]
                  },
                  {"name": "TS2", "min": 0},
                  {
                    "name": "claimPayments",
                    "type": "segment_group",
                    "max": -1,
                    "child_segments": [
                      {
                        "name": "CLP", 
                        "elements": [
                          {"name": "patient_control_number", "index": 1},
                          {"name": "claim_status_code", "index": 2},
                          {"name": "total_charge_amount", "index": 3, "default": "0"},
                          {"name": "total_payment_amount", "index": 4, "default": "0"},
                          {"name": "pat_resp_amount", "index": 5, "default": "0"},
                          {"name": "filing_indicator", "index": 6},
                          {"name": "claim_control_number", "index": 7},
                          {"name": "facility_code", "index": 8, "default": ""},
                          {"name": "claim_frequency_code", "index": 9, "default": ""}
                        ]
                      },
                      {
                        "name": "claimAdjustments", "type": "segment_group", "min": 0, "max": 99,
                        "child_segments": [
                          {
                            "name": "CAS", 
                            "elements": [
                              {"name":"adjustment_group_code", "index": 1},
                              {"name":"adjustment_reason_code", "index": 2},
                              {"name":"adjustment_amount", "index": 3, "default": "0"},
                              {"name":"adjustment_quantity", "index": 4}
                            ]
                          }
                        ]
                      },
                      {
                        "name": "NM1",
                        "max": 7,
                        "elements": [
                          {"name":"nm1_code", "index": 1},
                          {"name":"nm1_qualifier", "index": 2},
                          {"name":"last_name", "index": 3,"default": ""},
                          {"name":"first_name", "index": 4,"default": ""},
                          {"name":"middle_name", "index": 5,"default": ""},
                          {"name":"prefix", "index": 6,"default": ""},
                          {"name":"suffix", "index": 7,"default": ""},
                          {"name":"id_qualifier", "index": 8,"default": ""},
                          {"name":"id", "index": 9,"default": ""}
                        ]
                      },
                      {
                        "name": "MIA", "min": 0,
                        "elements": [
                          {"name": "covered_visits_total", "index": 1},
                          {"name": "payment_remark_code_1", "index": 2, "default": ""},
                          {"name": "payment_remark_code_2", "index": 20, "default": ""},
                          {"name": "payment_remark_code_3", "index": 21, "default": ""},
                          {"name": "payment_remark_code_4", "index": 22, "default": ""},
                          {"name": "payment_remark_code_5", "index": 23, "default": ""}
                        ]
                      },
                      {"name": "MOA", "min": 0,
                        "elements": [
                          {"name": "payment_remark_code_1", "index": 3, "default": ""},
                          {"name": "payment_remark_code_2", "index": 4, "default": ""},
                          {"name": "payment_remark_code_3", "index": 5, "default": ""},
                          {"name": "payment_remark_code_4", "index": 6, "default": ""},
                          {"name": "payment_remark_code_5", "index": 7, "default": ""}
                        ]
                      },
                      {"name": "REF", "min": 0, "max": 15,
                        "elements": [
                          {"name": "ref_qualifier", "index": 1},
                          {"name": "ref_id", "index": 2}
                        ]
                      },
                      {"name": "DTM", "min": 0, "max": 4,
                        "elements": [
                          {"name": "dtm_qualifier", "index": 1},
                          {"name": "dtm_date", "index": 2, "default": ""}
                        ]
                      },
                      {
                        "name": "PER", "min": 0, "max": 2,
                        "elements": [
                          {"name": "contact_function_code", "index": 1},
                          {"name": "contact_name", "index": 2, "default": ""},
                          {"name": "per_comm_qualifier_1", "index": 3, "default": ""},
                          {"name": "per_comm_1", "index": 4, "default": ""},
                          {"name": "per_comm_qualifier_2", "index": 5, "default": ""},
                          {"name": "per_comm_2", "index": 6, "default": ""},
                          {"name": "per_comm_qualifier_3", "index": 7, "default": ""},
                          {"name": "per_comm_3", "index": 8, "default": ""}
                        ]
                      },
                      {"name": "AMT", "min": 0, "max": 13,
                        "elements": [
                          {"name": "amt_qualifier", "index": 1},
                          {"name": "claim_supplemental_amt", "index": 2},
                          {"name": "credit_debit", "index": 3, "default": ""}
                        ]
                      },
                      {"name": "QTY", "min": 0, "max": 14},
                      {
                        "name": "services",
                        "type": "segment_group",
                        "max": -1,
                        "child_segments": [
                          {
                            "name": "SVC",
                            "elements": [
                              {"name": "service_id_qualifier", "index": 1, "component_index": 1},
                              {"name": "procedure_code", "index": 1, "component_index": 2},
                              {"name": "mod_1", "index": 1, "component_index": 3, "default": ""},
                              {"name": "mod_2", "index": 1, "component_index": 4, "default": ""},
                              {"name": "mod_3", "index": 1, "component_index": 5, "default": ""},
                              {"name": "mod_4", "index": 1, "component_index": 6, "default": ""},
                              {"name": "service_id_desc", "component_index": 1, "index": 7, "default": ""},
                              {"name": "service_id", "index": 1, "component_index": 8, "default": ""},
                              {"name": "charge_amount", "index": 2, "default": ""},
                              {"name": "payment_amount","index": 3, "default": ""},
                              {"name": "units_paid",  "index": 5, "default": ""},
                              {"name": "comp_service_id_qualifier", "index": 6, "component_index": 1, "default": ""},
                              {"name": "comp_procedure_code", "index": 6, "component_index": 2, "default": ""},
                              {"name": "comp_mod_1", "index": 6, "component_index": 3, "default": ""},
                              {"name": "comp_mod_2", "index": 6, "component_index": 4, "default": ""},
                              {"name": "comp_mod_3", "index": 6, "component_index": 5, "default": ""},
                              {"name": "comp_mod_4", "index": 6, "component_index": 6, "default": ""},
                              {"name": "comp_service_id_desc", "component_index": 6, "index": 7, "default": ""},
                              {"name": "service_id", "index": 1, "component_index": 8, "default": ""},
                              {"name": "original_units", "index": 7, "default": ""}
                            ]
                          },
                          {"name": "DTM", "min": 0, "max": 2,
                            "elements": [
                              {"name": "dtm_qualifier", "index": 1},
                              {"name": "dtm_date", "index": 2, "default": ""}
                            ]
                          },
                          {
                            "name": "serviceAdjustments", "type": "segment_group", "min": 0, "max": 99,
                            "child_segments": [
                              {
                                "name": "CAS", 
                                "elements": [
                                  {"name":"adjustment_group_code", "index": 1},
                                  {"name":"adjustment_reason_code", "index": 2},
                                  {"name":"adjustment_amount", "index": 3, "default": "0"},
                                  {"name":"adjustment_quantity", "index": 4, "default": "0"}
                                ]
                              }
                            ]
                          },
                          {"name": "REF", "min": 0, "max": 24,
                            "elements": [
                              {"name": "ref_qualifier", "index": 1},
                              {"name": "ref_id", "index": 2}
                            ]
                          },
                          {"name": "AMT", "min": 0, "max": 9,
                            "elements": [
                              {"name": "amt_qualifier", "index": 1},
                              {"name": "claim_supplemental_amt", "index": 2},
                              {"name": "credit_debit", "index": 3, "default": ""}
                            ]
                          },
                          {"name": "QTY", "min": 0, "max": 6},
                          {
                            "name": "LQ", "min": 0, "max": 99,
                            "elements": [
                              {"name": "remark_qualifier", "index": 1},
                              {"name": "remark", "index": 2}
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "name": "PLB", "min": 0, "max": -1,
                "elements": [
                  {"name": "npi", "index": 1},
                  {"name": "date", "index": 2},
                  {"name": "adj_reason_code", "index": 3, "component_index": 1},
                  {"name": "adj_reason_id", "index": 3, "component_index": 2, "default": ""},
                  {"name": "amt", "index": 4, "default": "0"}
                ]
              },
              {"name": "SE"}
            ]
          },
          {"name": "GE"},
          {"name": "IEA"}
        ]
      }
    ]
  },
  "transform_declarations": {
    "FINAL_OUTPUT": {
      "object": {
        "interchange_qualifier": {"xpath": "ISA/sender_interchange_qualifier", "template": "isa_interchange_qualifier_mapping"},
        "interchange_sender_id": {"xpath": "ISA/sender_id"},
        "transmission_date": {
          "custom_func": {
            "name": "javascript",
            "args": [
              {"const": "[dt.substring(0,4),dt.substring(4,6),dt.substring(6,8)].join('-') + 'T' + [tm.substring(0,2),tm.substring(2,4)].join(':') + 'Z'"},
              {"const": "dt"}, {"xpath": "GS/date"},
              {"const": "tm"}, {"xpath": "GS/time"}
            ]
          }
        },
        "application_sender_code": {"xpath": "GS/app_sender_code"},
        "transactions": {"array": [
          {"xpath":"transactions", "object": {
            "transaction_type": {"xpath": "BPR/transaction_handling_code", "template": "bpr01_handling_code"},
            "total_payment": {"xpath": "BPR/total_provider_payment"},
            "credit_debit": {"xpath": "BPR/credit_debit", "template": "bpr03_credit_debit"},
            "payment_method": {"xpath": "BPR/payment_method", "template": "bpr04_payment_method"},
            "payment_format": {"xpath": "BPR/payment_format", "template": "bpr05_payment_format"},
            "payer_ABA": {
              "custom_func": {
                "name": "javascript",
                "args": [
                  {"const": "dfi_ql=='01'? dfi_id : ''"},
                  {"const": "dfi_id"}, {"xpath": "BPR/sender_dfi_id"},
                  {"const": "dfi_ql"}, {"xpath": "BPR/sender_dfi_id_qualifier"}
                ]
              }
            },
            "payer_account_number": {
              "custom_func": {
                "name": "javascript",
                "args": [
                  {"const": "san_ql=='DA'? san_id : ''"},
                  {"const": "san_id"}, {"xpath": "BPR/sender_account_number"},
                  {"const": "san_ql"}, {"xpath": "BPR/sender_account_number_qualifier"}
                ]
              }
            },
            "payer_ftin": {
              "custom_func": {
                "name": "javascript",
                "args": [
                  {"const": "dfi_ql=='01'? dfi_id : payer_id"},
                  {"const": "dfi_id"}, {"xpath": "BPR/receiver_dfi_id"},
                  {"const": "dfi_ql"}, {"xpath": "BPR/receiver_dfi_id_qualifier"},
                  {"const": "payer_id"}, {"xpath": "TRN/payer_identifier"}
                ]
              }
            },
            "receiver_ABA": {
              "custom_func": {
                "name": "javascript",
                "args": [
                  {"const": "dfi_ql=='01'? dfi_id : ''"},
                  {"const": "dfi_id"}, {"xpath": "BPR/receiver_dfi_id"},
                  {"const": "dfi_ql"}, {"xpath": "BPR/receiver_dfi_id_qualifier"}
                ]
              }
            },
            "receiver_account_number": {
              "custom_func": {
                "name": "javascript",
                "args": [
                  {"const": "ran_ql=='DA'? ran_id : ''"},
                  {"const": "ran_id"}, {"xpath": "BPR/receiver_account_number"},
                  {"const": "ran_ql"}, {"xpath": "BPR/receiver_account_number_qualifier"}
                ]
              }
            },
            "transaction_date": {"xpath": "BPR/transaction_date", "template": "template_convert_date"},
            "check_eft_trace": {"xpath": "TRN/check_eft_trace"},
            "receiver_id": {"xpath": "REF[ref_qualifier='EV']/ref_id"},
            "version_id": {"xpath": "REF[ref_qualifier='F2']/ref_id"},
            "production_date": {"xpath": "DTM[dtm_qualifier='405']/dtm_date", "template": "template_convert_date"},
            "payer_info": {"array":[
              {"xpath": "payerInfo", "object": {
                "payer_name": {"xpath": "N1[n1_qualifier='PR']/name"},
                "payer_cms_plan_id": {"xpath": "N1[n1_qualifier='PR' and n1_id_qualifier='XV']/n1_id"},
                "address_line_1": {"xpath": "N3/address_line_1"},
                "address_line_2": {"xpath": "N3/address_line_2"},
                "city": {"xpath": "N4/city"},
                "state": {"xpath": "N4/state"},
                "zip": {"xpath": "N4/zip"},
                "payer_additional_id_type_1": {"xpath": "REF[position()=1][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_qualifier", "template": "ref_payer_qualifier"},
                "payer_additional_id_1": {"xpath": "REF[position()=1][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_id"},
                "payer_additional_id_type_2": {"xpath": "REF[position()=2][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_qualifier", "template": "ref_payer_qualifier"},
                "payer_additional_id_2": {"xpath": "REF[position()=2][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_id"},
                "payer_additional_id_type_3": {"xpath": "REF[position()=3][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_qualifier", "template": "ref_payer_qualifier"},
                "payer_additional_id_3": {"xpath": "REF[position()=3][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_id"},
                "payer_additional_id_type_4": {"xpath": "REF[position()=4][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_qualifier", "template": "ref_payer_qualifier"},
                "payer_additional_id_4": {"xpath": "REF[position()=4][ref_qualifier='2U' or ref_qualifier='EO' or ref_qualifier='HI' or ref_qualifier='NF']/ref_id"},
                "payer_business_contact_name": {"xpath": "PER[contact_function_code='CX']/contact_name"},
                "payer_business_contact_type_1": {"xpath": "PER[contact_function_code='CX' and not(per_comm_qualifier_1='')]/per_comm_qualifier_1", "template": "per_contact_qualifier"},
                "payer_business_contact_1": {"xpath": "PER[contact_function_code='CX' and not(per_comm_1='')]/per_comm_1"},
                "payer_business_contact_type_2": {"xpath": "PER[contact_function_code='CX' and not(per_comm_qualifier_2='')]/per_comm_qualifier_2", "template": "per_contact_qualifier"},
                "payer_business_contact_2": {"xpath": "PER[contact_function_code='CX' and not(per_comm_2='')]/per_comm_2"},
                "payer_business_contact_type_3": {"xpath": "PER[contact_function_code='CX' and not(per_comm_qualifier_3='')]/per_comm_qualifier_3", "template": "per_contact_qualifier"},
                "payer_business_contact_3": {"xpath": "PER[contact_function_code='CX' and not(per_comm_3='')]/per_comm_3"},
                "payer_technical_contact_name": {"xpath": "PER[contact_function_code='BL']/contact_name"},
                "payer_technical_contact_type_1": {"xpath": "PER[contact_function_code='BL' and not(per_comm_qualifier_1='')]/per_comm_qualifier_1", "template": "per_contact_qualifier"},
                "payer_technical_contact_1": {"xpath": "PER[contact_function_code='BL' and not(per_comm_1='')]/per_comm_1"},
                "payer_technical_contact_type_2": {"xpath": "PER[contact_function_code='BL' and not(per_comm_qualifier_2='')]/per_comm_qualifier_2", "template": "per_contact_qualifier"},
                "payer_technical_contact_2": {"xpath": "PER[contact_function_code='BL' and not(per_comm_2='')]/per_comm_2"},
                "payer_technical_contact_type_3": {"xpath": "PER[contact_function_code='BL' and not(per_comm_qualifier_3='')]/per_comm_qualifier_3", "template": "per_contact_qualifier"},
                "payer_technical_contact_3": {"xpath": "PER[contact_function_code='BL' and not(per_comm_3='')]/per_comm_3"},
                "payer_website": {"xpath": "PER[contact_function_code='IC' and per_comm_qualifier_1='UR']/per_comm_1"}
              }}
            ]},
            "payee_info": {"array":[
              {"xpath": "payeeInfo", "object": {
                "payee_name": {"xpath": "N1[n1_qualifier='PE']/name"},
                "payee_id_type": {"xpath": "N1[n1_qualifier='PE' and (n1_id_qualifier='XV' or n1_id_qualifier='XX' or n1_id_qualifier='FI')]/n1_id_qualifier", "template": "n1_payee_qualifier"},
                "payee_id": {"xpath": "N1[n1_qualifier='PE']/n1_id"},
                "address_line_1": {"xpath": "N3/address_line_1"},
                "address_line_2": {"xpath": "N3/address_line_2"},
                "city": {"xpath": "N4/city"},
                "state": {"xpath": "N4/state"},
                "zip": {"xpath": "N4/zip"},
                "payee_additional_id_type_1": {"xpath": "REF[position()=1][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_qualifier", "template": "ref_payee_qualifier"},
                "payee_additional_id_1": {"xpath": "REF[position()=1][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_id"},
                "payee_additional_id_type_2": {"xpath": "REF[position()=2][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_qualifier", "template": "ref_payee_qualifier"},
                "payee_additional_id_2": {"xpath": "REF[position()=2][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_id"},
                "payee_additional_id_type_3": {"xpath": "REF[position()=3][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_qualifier", "template": "ref_payee_qualifier"},
                "payee_additional_id_3": {"xpath": "REF[position()=3][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_id"},
                "payee_additional_id_type_4": {"xpath": "REF[position()=4][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_qualifier", "template": "ref_payee_qualifier"},
                "payee_additional_id_4": {"xpath": "REF[position()=4][ref_qualifier='0B' or ref_qualifier='D3' or ref_qualifier='PQ' or ref_qualifier='TJ']/ref_id"},
                "delivery_method": {"xpath": "RDM[rdm_code='BM' or rdm_code='EM' or rdm_code='FT' or rdm_code='OL']/rdm_code", "template": "rdm_transmission_code"}
              }}
            ]},
            "provider_claims": {"array": [
              {"xpath": "providerClaims", "object": {
                "provider_id": {"xpath": "TS3/provider_id"},
                "facility_code": {"xpath": "TS3/facility_code"},
                "claim_date": {"xpath": "TS3/date", "template": "template_convert_date"},
                "quantity": {"xpath": "TS3/quantity"},
                "total_charge_amount": {"xpath": "TS3/total_charge_amount", "type": "float"},
                "claim_payments": {"array": [
                  {"xpath": "claimPayments", "object": {
                    "patient_control_number": {"xpath": "CLP/patient_control_number"},
                    "claim_status_code": {"xpath": "CLP/claim_status_code"},
                    "total_charge_amount": {"xpath": "CLP/total_charge_amount", "template": "convert_to_float"},
                    "total_payment_amount": {"xpath": "CLP/total_payment_amount", "template": "convert_to_float"},
                    "pat_resp_amount": {"xpath": "CLP/pat_resp_amount", "template": "convert_to_float"},
                    "filing_indicator": {"xpath": "CLP/filing_indicator"},
                    "claim_control_number": {"xpath": "CLP/claim_control_number"},
                    "facility_code": {"xpath": "CLP/facility_code"},
                    "claim_adjustments": {"array": [
                      {"xpath": "claimAdjustments", "object": {
                        "adjustment_group_code": {"xpath": "CAS/adjustment_group_code"},
                        "adjustment_reason_code": {"xpath": "CAS/adjustment_reason_code"},
                        "adjustment_amount": {"xpath": "CAS/adjustment_amount", "template": "convert_to_float"},
                        "adjustment_quantity": {"xpath": "CAS/adjustment_quantity", "template": "convert_to_int"}
                      }}
                    ]},
                    "patient_info": {"array":  [
                      {"xpath": "NM1[nm1_code='QC']", "object": {
                        "prefix": {"xpath": "prefix"},
                        "first_name": {"xpath": "first_name"},
                        "middle_name": {"xpath": "middle_name"},
                        "last_name": {"xpath": "last_name"},
                        "suffix": {"xpath": "suffix"},
                        "patient_id_type": {"xpath": "id_qualifier", "template": "nm1_id_qualifier"},
                        "patient_id": {"xpath": "id"}
                      }}
                    ]},
                    "insured_info": {"array":  [
                      {"xpath": "NM1[nm1_code='IL']", "object": {
                        "prefix": {"xpath": "prefix"},
                        "first_name": {"xpath": "first_name"},
                        "middle_name": {"xpath": "middle_name"},
                        "last_name": {"xpath": "last_name"},
                        "suffix": {"xpath": "suffix"},
                        "insured_id_type": {"xpath": "id_qualifier", "template": "nm1_id_qualifier"},
                        "insured_id": {"xpath": "id"}
                      }}
                    ]},
                    "corrected_patient_insured_info": {"array":  [
                      {"xpath": "NM1[nm1_code='74']", "object": {
                        "prefix": {"xpath": "prefix"},
                        "first_name": {"xpath": "first_name"},
                        "middle_name": {"xpath": "middle_name"},
                        "last_name": {"xpath": "last_name"},
                        "suffix": {"xpath": "suffix"},
                        "corrected_patient_insured_type": {"xpath": "id_qualifier", "template": "nm1_id_qualifier"},
                        "corrected_patient_insured_id": {"xpath": "id"}
                      }}
                    ]},
                    "provider_info": {"array":  [
                      {"xpath": "NM1[nm1_code='82']", "object": {
                        "prefix": {"xpath": "prefix"},
                        "first_name": {"xpath": "first_name"},
                        "middle_name": {"xpath": "middle_name"},
                        "last_name": {"xpath": "last_name"},
                        "suffix": {"xpath": "suffix"},
                        "provider_id_type": {"xpath": "id_qualifier", "template": "nm1_id_qualifier"},
                        "provider_id": {"xpath": "id"}
                      }}
                    ]},
                    "corrected_payer_info": {"array":  [
                      {"xpath": "NM1[nm1_code='PR']", "object": {
                        "name": {"xpath": "first_name"},
                        "corrected_payer_id_type": {"xpath": "id_qualifier", "template": "nm1_id_qualifier"},
                        "corrected_payer_id": {"xpath": "id"}
                      }}
                    ]},
                    "other_subscriber_info": {"array":  [
                      {"xpath": "NM1[nm1_code='GB']", "object": {
                        "prefix": {"xpath": "prefix"},
                        "first_name": {"xpath": "first_name"},
                        "middle_name": {"xpath": "middle_name"},
                        "last_name": {"xpath": "last_name"},
                        "suffix": {"xpath": "suffix"},
                        "other_subscriber_id_type": {"xpath": "id_qualifier", "template": "nm1_id_qualifier"},
                        "other_subscriber_id": {"xpath": "id"}
                      }}
                    ]},
                    "covered_days_visits": {"xpath": "MIA/covered_visits_total", "template": "convert_to_int"},
                    "inpatient_claim_payment_remarks": {"array":  [
                      {"xpath": "MIA", "object": {
                        "remark_code_1": {"xpath": "payment_remark_code_1"},
                        "remark_code_2": {"xpath": "payment_remark_code_2"},
                        "remark_code_3": {"xpath": "payment_remark_code_3"},
                        "remark_code_4": {"xpath": "payment_remark_code_4"},
                        "remark_code_5": {"xpath": "payment_remark_code_5"}
                      }}
                    ]},
                    "outpatient_claim_payment_remarks": {"array":  [
                      {"xpath": "MOA", "object": {
                        "remark_code_1": {"xpath": "payment_remark_code_1"},
                        "remark_code_2": {"xpath": "payment_remark_code_2"},
                        "remark_code_3": {"xpath": "payment_remark_code_3"},
                        "remark_code_4": {"xpath": "payment_remark_code_4"},
                        "remark_code_5": {"xpath": "payment_remark_code_5"}
                      }}
                    ]},
                    "other_claim_info": {"array":  [
                      {"xpath": "REF[position()<=5][ref_qualifier='1L' or ref_qualifier='1W' or ref_qualifier='28' or ref_qualifier='6P' or ref_qualifier='9A' or ref_qualifier='9C' or ref_qualifier='BB' or ref_qualifier='CE' or ref_qualifier='EA' or ref_qualifier='F8' or ref_qualifier='G1' or ref_qualifier='G3' or ref_qualifier='IG' or ref_qualifier='SY']", "object": {
                        "claim_info_type": {"xpath": "ref_qualifier", "template": "ref_claim_qualifier"},
                        "claim_info_id": {"xpath": "ref_id"}
                      }}
                    ]},
                    "other_provider_info": {"array":  [
                      {"xpath": "REF[position()<=15][ref_qualifier='0B' or ref_qualifier='1A' or ref_qualifier='1B' or ref_qualifier='1C' or ref_qualifier='1D' or ref_qualifier='1G' or ref_qualifier='1H' or ref_qualifier='1J' or ref_qualifier='D3' or ref_qualifier='G2' or ref_qualifier='LU']", "object": {
                        "claim_info_type": {"xpath": "ref_qualifier", "template": "ref_provider_qualifier"},
                        "claim_info_id": {"xpath": "ref_id"}
                      }}
                    ]},
                    "statement_start_date": {"xpath": "DTM[dtm_qualifier='232']/dtm_date", "template": "template_convert_date"},
                    "statement_end_date": {"xpath": "DTM[dtm_qualifier='233']/dtm_date", "template": "template_convert_date"},
                    "coverage_expiration_date": {"xpath": "DTM[dtm_qualifier='036']/dtm_date", "template": "template_convert_date"},
                    "claim_received_date": {"xpath": "DTM[dtm_qualifier='050']/dtm_date", "template": "template_convert_date"},
                    "claim_contact_info": {"array":  [
                      {"xpath": ".", "object": {
                        "claim_contact_type_1": {"xpath": "PER[contact_function_code='CX' and not(per_comm_qualifier_1='')]/per_comm_qualifier_1", "template": "per_contact_qualifier"},
                        "claim_contact_1": {"xpath": "PER[contact_function_code='CX' and not(per_comm_1='')]/per_comm_1"},
                        "claim_contact_type_2": {"xpath": "PER[contact_function_code='CX' and not(per_comm_qualifier_2='')]/per_comm_qualifier_2", "template": "per_contact_qualifier"},
                        "claim_contact_2": {"xpath": "PER[contact_function_code='CX' and not(per_comm_2='')]/per_comm_2"},
                        "claim_contact_type_3": {"xpath": "PER[contact_function_code='CX' and not(per_comm_qualifier_3='')]/per_comm_qualifier_3", "template": "per_contact_qualifier"},
                        "claim_contact_3": {"xpath": "PER[contact_function_code='CX' and not(per_comm_3='')]/per_comm_3"}
                      }}
                    ]},
                    "claim_supplemental_amounts": {"array":  [
                      {"xpath": "AMT", "object": {
                        "claim_supplemental_amt_type": {"xpath": "amt_qualifier", "template": "amt_amt_qualifier"},
                        "claim_supplemental_amt": {"xpath": "claim_supplemental_amt", "template": "convert_to_float"},
                        "credit_debit": {"xpath": "credit_debit"}
                      }}
                    ]},
                    "services": {"array":  [
                      {"xpath": "services", "object": {
                        "cpt": {"xpath": "SVC[service_id_qualifier='HC']/procedure_code"},
                        "cpt_modifier_1": {"xpath": "SVC[service_id_qualifier='HC']/mod_1"},
                        "cpt_modifier_2": {"xpath": "SVC[service_id_qualifier='HC']/mod_2"},
                        "cpt_modifier_3": {"xpath": "SVC[service_id_qualifier='HC']/mod_3"},
                        "cpt_modifier_4": {"xpath": "SVC[service_id_qualifier='HC']/mod_4"},
                        "composite_cpt": {"xpath": "SVC[service_id_qualifier='HC']/comp_procedure_code"},
                        "composite_modifier_1": {"xpath": "SVC[service_id_qualifier='HC']/comp_mod_1"},
                        "composite_modifier_2": {"xpath": "SVC[service_id_qualifier='HC']/comp_mod_2"},
                        "composite_modifier_3": {"xpath": "SVC[service_id_qualifier='HC']/comp_mod_3"},
                        "composite_modifier_4": {"xpath": "SVC[service_id_qualifier='HC']/comp_mod_4"},
                        "charge_amount": {"xpath": "SVC[service_id_qualifier='HC']/charge_amount", "template": "convert_to_float"},
                        "payment_amount": {"xpath": "SVC[service_id_qualifier='HC']/payment_amount", "template": "convert_to_float"},
                        "units_paid": {"xpath": "SVC[service_id_qualifier='HC']/units_paid", "template": "convert_to_int"},
                        "original_units": {"xpath": "SVC[service_id_qualifier='HC']/original_units", "template": "convert_to_int"},
                        "service_date_start": {"xpath": "DTM[dtm_qualifier='150' or dtm_qualifier='472']/dtm_date", "template": "template_convert_date"},
                        "service_date_end": {"xpath": "DTM[dtm_qualifier='151' or dtm_qualifier='472']/dtm_date", "template": "template_convert_date"},
                        "service_adjustments": {"array": [
                          {"xpath": "serviceAdjustments", "object": {
                            "adjustment_group_code": {"xpath": "CAS/adjustment_group_code"},
                            "adjustment_reason_code": {"xpath": "CAS/adjustment_reason_code"},
                            "adjustment_amount": {"xpath": "CAS/adjustment_amount", "template": "convert_to_float"},
                            "adjustment_quantity": {"xpath": "CAS/adjustment_quantity", "template": "convert_to_int"}
                          }}
                        ]},
                        "service_ids": {"array":  [
                          {"xpath": "REF[position()<=8][ref_qualifier='1S' or ref_qualifier='APC' or ref_qualifier='BB' or ref_qualifier='E9' or ref_qualifier='G1' or ref_qualifier='G3' or ref_qualifier='LU' or ref_qualifier='RB']", "object": {
                            "claim_info_type": {"xpath": "ref_qualifier", "template": "ref_service_qualifier"},
                            "claim_info_id": {"xpath": "ref_id"}
                          }}
                        ]},
                        "line_item_control_number": {"xpath": "REF[position()<=9][ref_qualifier='6R']/ref_id"},
                        "rendering_provider_info": {"array":  [
                          {"xpath": "REF[position()<=19][ref_qualifier='0B' or ref_qualifier='1A' or ref_qualifier='1B' or ref_qualifier='1C' or ref_qualifier='1D' or ref_qualifier='1G' or ref_qualifier='1H' or ref_qualifier='1J' or ref_qualifier='D3' or ref_qualifier='G2' or ref_qualifier='HPI' or ref_qualifier='TJ']", "object": {
                            "claim_info_type": {"xpath": "ref_qualifier", "template": "ref_provider_qualifier"},
                            "claim_info_id": {"xpath": "ref_id"}
                          }}
                        ]},
                        "healthcare_policy_forms": {"array":  [
                          {"xpath": "REF[ref_qualifier='0K']", "object": {
                            "id": {"xpath": "ref_id"}
                          }}
                        ]},
                        "service_supplemental_amounts": {"array":  [
                          {"xpath": "AMT", "object": {
                            "claim_supplemental_amt_type": {"xpath": "amt_qualifier", "template": "amt_amt_qualifier"},
                            "claim_supplemental_amt": {"xpath": "claim_supplemental_amt", "template": "convert_to_float"},
                            "credit_debit": {"xpath": "credit_debit"}
                          }}
                        ]},
                        "service_remarks": {"array":  [
                          {"xpath": "LQ[remark_qualifier='HE']", "object": {
                            "code": {"xpath": "remark"}
                          }}
                        ]}
                      }}
                    ]}
                  }}
                ]}
              }}
            ]},
            "provider_adjustments": {"array":  [
              {"xpath": "PLB", "object": {
                "npi": {"xpath": "npi"},
                "date": {"xpath": "date", "template": "template_convert_date"},
                "reason_code": {"xpath": "adj_reason_code"},
                "reason_id": {"xpath": "adj_reason_id"},
                "amount": {"xpath": "amt", "template": "convert_to_float"}
              }}
            ]}
          }}
        ]}
      }
    },
    "template_convert_date": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "dt.length == 8? [dt.substring(0,4),dt.substring(4,6),dt.substring(6,8)].join('-') + 'T00:00Z' : ''"},
          {"const": "dt"}, {"xpath": "."}
        ]
      }
    },
    "convert_to_float": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "val ? parseFloat(val) : ''"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "convert_to_int": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "val ? parseInt(val) : ''"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "isa_interchange_qualifier_mapping": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '30': 'FTIN'; break; default: 'Other'};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "bpr01_handling_code": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'H': 'Notification'; break; case 'I': 'Remittance'; break; default: 'Other'};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "bpr03_credit_debit": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'C': 'Credit'; break; case 'D': 'Debit'; break; default: 'Other'};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "bpr04_payment_method": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'ACH': 'ACH'; break; case 'CHK': 'Check'; break; case 'NON': 'Non-Payment Data'; break; default: 'Other'};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "bpr05_payment_format": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'CCP': 'Cash'; break; case 'CTX': 'Corporate Trade Exchange'; break; default: 'Other'};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "bpr08_sender_account_number_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'DA': 'Demand Deposit'; break; case 'SG': 'Savings'; break; default: 'Other'};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "per_contact_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'EM': 'Email'; break; case 'TE': 'Phone'; break; case 'FX': 'Fax'; break; case 'UR': 'Website'; break; case 'EX': 'Extension'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "ref_payer_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '2U': 'Payer ID'; break; case 'EO': 'Submitter ID'; break; case 'HI': 'HIN'; break; case 'NF': 'NAIC'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "ref_payee_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '0B': 'State License Number'; break; case 'D3': 'NCPDP ID'; break; case 'PQ': 'Payee ID'; break; case 'TJ': 'FTIN'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "n1_payee_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'XV': 'CMS Plan ID'; break; case 'XX': 'NPI'; break; case 'FI': 'FTIN'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "rdm_transmission_code": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'BM': 'Mail'; break; case 'EM': 'Email'; break; case 'FT': 'FTP'; break; case 'OL': 'Online'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "nm1_id_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '34': 'SSN'; break; case 'HN': 'HIC Number'; break; case 'II': 'NPI'; break; case 'MI': 'Member ID'; break; case 'MM': 'Medicaid ID'; break; case 'FI': 'FTIN'; break; case 'BD': 'Blue Cross Provider Number'; break; case 'BS': 'Blue Shield Provider Number'; break; case 'MC': 'Medicaid Provider Number'; break; case 'PC': 'Provider Commercial Number'; break; case 'SL': 'State License Number'; break; case 'UP': 'UPIN'; break; case 'XX': 'NPI'; break; case 'AD': 'BCBS Plan Code'; break; case 'NI': 'NAIC'; break; case 'PI': 'Payor ID'; break; case 'PP': 'Pharmacy Processer Number'; break; case 'XV': 'CMS Plan ID'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "ref_claim_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '1L': 'Group Policy Number'; break; case '1W': 'Member ID'; break; case '28': 'Employee ID'; break; case '6P': 'Group Number'; break; case '9A': 'Repriced Claim Ref Number'; break; case '9C': 'Adj. Repriced Claim Ref Number'; break; case 'BB': 'Authorization Number'; break; case 'CE': 'Class of Contract Code'; break; case 'EA': 'MRN'; break; case 'F8': 'Original ref Number'; break; case 'G1': 'Prior Auth Number'; break; case 'G3': 'Predetermination of Benefits Number'; break; case 'IG': 'Ins. Policy Number'; break; case 'SY': 'SSN'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "ref_provider_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '0B': 'State License Number'; break; case '1A': 'Blue Cross Provider Number'; break; case '1B': 'Blue Shield Provider Number'; break; case '1C': 'Medicare Provider Number'; break; case '1D': 'Medicaid Provider Number'; break; case '1G': 'Provider UPIN Number'; break; case '1H': 'CHAMPUS Number'; break; case '1J': 'Facility ID'; break; case 'D3': 'NCPDP ID'; break; case 'G2': 'Provider Commercial Number'; break; case 'LU': 'Location Number', 'HPI': 'NPI'; break; case 'TJ': 'FTIN'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "amt_amt_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case 'AU': 'Coverage Amount'; break; case 'B6': 'Allowed - Actual'; break; case 'D8': 'Discount Amount'; break; case 'DY': 'Per Day Limit'; break; case 'F5': 'Patient Amount Paid'; break; case 'KH': 'Deduction Amount'; break; case 'I': 'Interest'; break; case 'NL': 'Neg. Ledger Balance'; break; case 'T': 'Tax'; break; case 'T2': 'Total Claim Before Taxes'; break; case 'ZK': 'Medicare/Medicaid Payment - Category 1'; break; case 'ZL': 'Medicare/Medicaid Payment - Category 2'; break; case 'ZM': 'Medicare/Medicaid Payment - Category 3'; break; case 'ZN': 'Medicare/Medicaid Payment - Category 4'; break; case 'ZO': 'Medicare/Medicaid Payment - Category 5'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    },
    "ref_service_qualifier": {
      "custom_func": {
        "name": "javascript",
        "args": [
          {"const": "switch (val) {case '1S': 'APG Number'; break; case 'APC': 'Amb Payment Classification'; break; case 'BB': 'Auth Number'; break; case 'E9': 'Attachment code'; break; case 'G1': 'Prior Auth Number'; break; case 'G3': 'Predetermination of Benefits Number'; break; case 'LU': 'Location Number'; break; case 'RB': 'Rate Code Number'; break; default: ''};"},
          {"const": "val"}, {"xpath": "."}
        ]
      }
    }
  }
}
